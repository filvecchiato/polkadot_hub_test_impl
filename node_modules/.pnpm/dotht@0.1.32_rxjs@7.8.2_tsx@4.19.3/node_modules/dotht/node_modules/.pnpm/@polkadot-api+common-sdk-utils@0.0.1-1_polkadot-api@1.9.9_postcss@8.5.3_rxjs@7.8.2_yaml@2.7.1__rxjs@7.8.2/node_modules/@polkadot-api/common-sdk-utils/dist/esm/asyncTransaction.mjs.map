{"version":3,"file":"asyncTransaction.mjs","sources":["../../src/asyncTransaction.ts"],"sourcesContent":["import type { Transaction, Binary } from \"polkadot-api\"\nimport { from, switchMap } from \"rxjs\"\n\nexport type AsyncTransaction<\n  Arg extends {} | undefined,\n  Pallet extends string,\n  Name extends string,\n  Asset,\n> = Omit<\n  Transaction<Arg, Pallet, Name, Asset>,\n  \"decodedCall\" | \"getEncodedData\"\n> & {\n  decodedCall: Promise<Transaction<Arg, Pallet, Name, Asset>[\"decodedCall\"]>\n  getEncodedData: () => Promise<Binary>\n}\n\nexport const wrapAsyncTx = <\n  Arg extends {} | undefined,\n  Pallet extends string,\n  Name extends string,\n  Asset,\n>(\n  fn: () => Promise<Transaction<Arg, Pallet, Name, Asset>>,\n): AsyncTransaction<Arg, Pallet, Name, Asset> => {\n  const promise = fn()\n  return {\n    sign: (...args) => promise.then((tx) => tx.sign(...args)),\n    signSubmitAndWatch: (...args) =>\n      from(promise).pipe(switchMap((tx) => tx.signSubmitAndWatch(...args))),\n    signAndSubmit: (...args) => promise.then((tx) => tx.signAndSubmit(...args)),\n    getEstimatedFees: (...args) =>\n      promise.then((tx) => tx.getEstimatedFees(...args)),\n    getPaymentInfo: (...args) =>\n      promise.then((tx) => tx.getPaymentInfo(...args)),\n    decodedCall: promise.then((tx) => tx.decodedCall),\n    getEncodedData: () => promise.then((tx) => tx.getEncodedData()),\n  }\n}\n"],"names":[],"mappings":";;AAgBa,MAAA,WAAA,GAAc,CAMzB,EAC+C,KAAA;AAC/C,EAAA,MAAM,UAAU,EAAG,EAAA;AACnB,EAAO,OAAA;AAAA,IACL,IAAA,EAAM,CAAI,GAAA,IAAA,KAAS,OAAQ,CAAA,IAAA,CAAK,CAAC,EAAA,KAAO,EAAG,CAAA,IAAA,CAAK,GAAG,IAAI,CAAC,CAAA;AAAA,IACxD,kBAAoB,EAAA,CAAA,GAAI,IACtB,KAAA,IAAA,CAAK,OAAO,CAAE,CAAA,IAAA,CAAK,SAAU,CAAA,CAAC,OAAO,EAAG,CAAA,kBAAA,CAAmB,GAAG,IAAI,CAAC,CAAC,CAAA;AAAA,IACtE,aAAA,EAAe,CAAI,GAAA,IAAA,KAAS,OAAQ,CAAA,IAAA,CAAK,CAAC,EAAA,KAAO,EAAG,CAAA,aAAA,CAAc,GAAG,IAAI,CAAC,CAAA;AAAA,IAC1E,gBAAA,EAAkB,CAAI,GAAA,IAAA,KACpB,OAAQ,CAAA,IAAA,CAAK,CAAC,EAAA,KAAO,EAAG,CAAA,gBAAA,CAAiB,GAAG,IAAI,CAAC,CAAA;AAAA,IACnD,cAAA,EAAgB,CAAI,GAAA,IAAA,KAClB,OAAQ,CAAA,IAAA,CAAK,CAAC,EAAA,KAAO,EAAG,CAAA,cAAA,CAAe,GAAG,IAAI,CAAC,CAAA;AAAA,IACjD,aAAa,OAAQ,CAAA,IAAA,CAAK,CAAC,EAAA,KAAO,GAAG,WAAW,CAAA;AAAA,IAChD,cAAA,EAAgB,MAAM,OAAQ,CAAA,IAAA,CAAK,CAAC,EAAO,KAAA,EAAA,CAAG,gBAAgB;AAAA,GAChE;AACF;;;;"}